name: Continuous Integration

on:
  pull_request:
  push:
  workflow_dispatch:
  #schedule:
  #- cron: '30 0 * * MON'  

jobs:
  build:
    name: Build and Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - run: npm ci
      - run: npm run build
      - run: npm test

  self-test:
    name: Self Test
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@main
    - name: self test
      uses: ./
      with:
        token: ${{ github.token }}
        fail-if-no-assets: false
        tag: test_tag
        assets: |
          foo.*
          assets.txt
